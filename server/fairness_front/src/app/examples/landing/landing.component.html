<div class="main">

    <div class="section text-center">
        <div style="margin-top: 50px;" class="container">
            <div class="row">
                <div style="text-align: left;">
                    
                    <h2>Welcome!</h2> <br/>
                    <p style="text-align: justify;">
                        
                        This is the project page for the  Scientific Team Project on Fair Recommendation in Research. <br/><br/><br/><br/>
                        
                        This project is designed to study the impact of bias and fairness constraints that are featured most by contemporary literature. 
                        Based on the dataset provided by Georg Eckert Institute for International Textbook Research, we want to show you a regular recommendation and a bias corrected version of the same recommendation. 
                        Our hope is this experiement should help us understand the impact of these bias correction techniques. 

                        <br/><br/><br/>

                        Below, you will see some input that you must select in order play with this recommendation. Both the User Name field and the Research Interest field are searchable database 
                        of all the available users and research interests. Furthermore, the preference slider will give us your preference value. If you say 0.4, we will consider you prefer to put 
                        40% of the weight to similarity and 60% to distance. 
                        <br/><br/><br/>
                        
                        Please checkout <a target="_blank" href="http://localhost:8080/swagger/">this link</a> for swagger documentation of the back-end API. <br/>
                        You can also visit <a target="_blank" href="http://localhost:8080/redoc/">this page</a> for a different view of the same documentation. 

                    </p>
                <br/>
                
                
                </div>
            </div>
            <div id="not_found_div" hidden>
                <h3>Looks like you haven't configured the volume mapping of docker-compose properly. <br/>Please fix it and try again after restarting the server.</h3>
            </div>
            <div id="input_compartment" hidden>
                <h3>Inputs for Recommendation</h3>
                <br/><br/><br/>

            
                <div class="row">
                    <div style="margin-right: 30px;"  class="col-md-4">
                        <div style="display: inline-flex;" class="row">
                            <div class="col-md-3" style="padding-left: 0px; padding-right: 0px; position: relative; left: 5px; top: 10px;">
                                User Name
                            </div>
                            <div class="ng-autocomplete col-md-5">
                                <ng-autocomplete
                                [data]="users"
                                [searchKeyword]="keyword"
                                placeholder="Search for User Name"
                                (selected)='userSelectEvent($event)'
                                (inputChanged)='userOnChangeSearch($event)'
                                (inputFocused)='userOnFocused($event)'
                                historyIdentifier="users"
                                [itemTemplate]="itemTemplate"
                                [notFoundTemplate]="notFoundTemplate">
                                </ng-autocomplete>
                            
                                <ng-template #itemTemplate let-item>
                                <a [innerHTML]="item.name"></a>
                                </ng-template>
                            
                                <ng-template #notFoundTemplate let-notFound>
                                <div [innerHTML]="notFound"></div>
                                </ng-template>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div style="display: inline-flex;" class="row">
                            <div class="col-md-3">
                                <label>Research Interest</label>
                            </div>
                            <div class="ng-autocomplete col-md-7" style="width: 300px;">
                                
                                <ng-autocomplete
                                [data]="research_interests"
                                [searchKeyword]="keyword"
                                placeholder="Search for Research ..."
                                (selected)='interestSelectEvent($event)'
                                (inputChanged)='interestOnChangeSearch($event)'
                                (inputFocused)='interestOnFocused($event)'
                                historyIdentifier="research_interests"
                                [itemTemplate]="itemTemplate"
                                [notFoundTemplate]="notFoundTemplate">
                                </ng-autocomplete>
                            
                                <ng-template #itemTemplate let-item>
                                <a [innerHTML]="item.name"></a>
                                </ng-template>
                            
                                <ng-template #notFoundTemplate let-notFound>
                                <div [innerHTML]="notFound"></div>
                                </ng-template>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label>Preference: Similarity - Distance</label>
                        <nouislider [connect]="false" [min]="0" [max]="1" [step]="0.01" [(ngModel)]="simpleSlider"
                            [tooltips]="true" [behaviour]="snap" class="slider"></nouislider>
                    </div>
        
                </div>
                <br /><br />
                <div class="row">
                    <div class="col-md-12">
                        <button (click)="loadRecommendationData()" 
                                type="button" 
                                *ngIf="selected_user != null && selected_interest != null"
                                class="btn btn-default btn-lg">
                            Get Suggestions
                        </button>
                    </div>
                </div>
                <br /><br />
                <div id="result_section" class="row" hidden>
                    <div class="col-md-5">
                        <div class="row">
                            <label class="pull-left"><h4>Before Bias Correction</h4></label>
                        </div>
                        
                        <div class="row">
                            <div *ngFor="let item of with_bias" class="card col-md-12">
                                <div class="card-body" (click)="clickResponse1(item)">
                                    <div class="row">
                                        <div class="col-md-6 pull-left">
                                            <h5 class="card-title"> {{ item.name }} </h5>
                                        </div>
                                        <div class="col-md-6 pull-right">
                                            <label class="pull-right"> <h6>{{item.score}}, {{item.cosine_sim}}, {{item.hop_distance}}</h6></label>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-12 pull-left">
                                            <label>{{ item.research_interests }} </label>
                                            <br/>
                                            <label> {{ item.gender }}, {{ item.nationality }} </label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    </div>
                                </div>
                                <div id="{{ item.uuid }}-biased" class="cardInfo pull-right" (click)="biased_paper_card_click(item)" hidden>
                                    <h5 id= "div_1_title"class="card-title">Literature List</h5>
                                    <div *ngFor="let paper of item.publication_list" class="card col-md-12">
                                        <div class="row">
                                            <p class="card-text">{{ paper.title }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    <div class="col-md-2">

                    </div>
                    <div class="col-md-5">
                        <div class="row">
                            <label class="pull-left"><h4>After Bias Correction</h4></label>
                        </div>
                        <div class="row">
                            <div *ngFor="let item of bias_corrected; index as i" class="card col-md-12">
                                <div class="card-body" (click)="clickResponse2(item)">
                                    <div class="row">
                                        <div class="col-md-6 pull-left">
                                            <h5 class="card-title"> {{ item.name }} </h5>
                                        </div>
                                        <div class="col-md-6 pull-right">
                                            <label class="pull-right"> <h6>{{item.score}}, {{item.cosine_sim}}, {{item.hop_distance}}</h6></label>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-12 pull-left">
                                            <label> {{ item.research_interests }} </label>
                                            <br/>
                                            <label> {{ item.gender }}, {{ item.nationality }} </label>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-2 pull-left">

                                            <label *ngIf="item.bias_ref > ((page_size * (page-1) ) + i)"> <i class="nc-icon nc-minimal-up"></i> {{ item.bias_ref - ((page_size * (page-1) ) + i) }}</label>
                                            <label *ngIf="item.bias_ref < ((page_size * (page-1) ) + i)"> <i class="nc-icon nc-minimal-down"></i> {{ ((page_size * (page-1) ) + i) - item.bias_ref }}</label>
                                            <label *ngIf="item.bias_ref == ((page_size * (page-1) ) + i)"> <i class="nc-icon nc-simple-remove"></i> {{ ((page_size * (page-1) ) + i) - item.bias_ref }}</label>
                                            
                                            <!-- <label> <i class="fas fa-arrow-up"></i> {{ item.bias_ref }}</label> -->
                                        </div>
                                    </div>

                                </div>
                                <div id="{{ item.uuid }}-corrected" class="cardInfo pull-right" (click)="corrected_paper_card_click(item)" hidden>
                                    <h5 id= "div_1_title"class="card-title">Literature List</h5>
                                    <div *ngFor="let paper of item.publication_list" class="card col-md-12">
                                        <div class="row">
                                            <p class="card-text">{{ paper.title }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12" id="pagination_div" hidden>
                <ngb-pagination (pageChange)="onPageChange($event)" [collectionSize]="collection_size" [(page)]="page" [maxSize]="5" [rotate]="true">
                </ngb-pagination>
            </div>
        </div>
    </div>
</div>